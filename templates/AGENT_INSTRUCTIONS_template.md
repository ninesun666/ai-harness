# Agent Instructions
# 此文件定义 coding agent 的工作流程和行为规范

## 会话开始流程

每个 coding agent 会话必须按以下顺序开始：

1. **定位环境**
   ```bash
   pwd  # 确认工作目录
   ```

2. **读取进度**
   - 阅读 `.agent-harness/claude-progress.txt`
   - 查看 `git log --oneline -10`
   - 了解最近的工作内容

3. **检查功能状态**
   - 阅读 `.agent-harness/feature_list.json`
   - 找到最高优先级的未完成功能

4. **验证环境**
   - 确保开发环境可用
   - 运行基础功能测试
   - 确保没有已存在的 bug

5. **开始工作**
   - 选择一个功能开始实现
   - 遵循增量开发原则

## 会话结束流程

每个 coding agent 会话必须按以下顺序结束：

1. **测试验证**
   - 运行单元测试
   - 运行端到端测试
   - 手动验证功能

2. **更新状态**
   - 更新 `feature_list.json` 中的功能状态
   - 只在确认通过后设置 `passes: true`

3. **提交代码**
   ```bash
   git add .
   git commit -m "feat: [功能描述]"
   ```

4. **记录进度**
   - 更新 `claude-progress.txt`
   - 记录完成的工作
   - 记录遇到的问题
   - 记录下一步建议

5. **清理环境**
   - 确保没有未完成的代码
   - 确保没有破坏其他功能

## 重要原则

### 增量开发
- 每次只处理一个功能
- 不要尝试一次性完成多个功能
- 小步快跑，频繁提交

### 测试驱动
- 在标记功能完成前必须测试
- 不要依赖代码审查来发现 bug

### 状态清晰
- 代码提交信息要清晰描述改动
- 进度文件要记录完整的上下文
- 让下一个 agent 能快速理解当前状态

### 质量优先
- 不删除或修改测试用例
- 不跳过失败的测试
- 不在代码中留下 TODO 或 FIXME

## 禁止行为

1. ❌ 删除 feature_list.json 中的功能
2. ❌ 在未测试时将 passes 设为 true
3. ❌ 一次性实现多个功能
4. ❌ 提交无法运行的代码
5. ❌ 忽略已有的 bug
